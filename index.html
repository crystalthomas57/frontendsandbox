<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login Page</title>

     <!-- needed to import the style.css file -->
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class = "header">
      <div class=" header-right">
        <a href="#home">Home</a>
        <a href="database" >Database</a>
        <a href=" about">About</a>
      </div> 

    </div>
    <center>
        <!-- wraps information in a container -->
      <div class="container">
        <h1><center>Lookup student</center></h1>
        <img
          src="loginimage.jpeg"
          alt="Login Person"
        />
        <!-- <div class="narrow-container" algin>
      <div class="card"></div> -->
    <!-- in the method the action can be one of twp things GET or POST -->
     <!-- GET method shows all the infomation in the url the user sees and POST doesnt show data in url -->
      <!-- if no reason to show data in url to bookmark use a POST -->
      <!-- <form action = "" method = "" > -->
        <!-- <button type ="button" onclick="saveData()"> Save </button>
        
  <label for="username">Username: 
  <br>
  <input type="text" id="userInput" placeholder="username" ><br>

  <br>
  <input type="text" id="userInput" placeholder="username" ><br>
</form>
<div> 
  <h2> Saved Data:</h2>
  <p id = "SavedData"> </p>
</div>
<div>
  <Response class="write">
    Take the data from textbox and post to main py
userInput - look up get value from DOM textbox
  </Response>
</div> -->
<input type="text" id="student_id" placeholder="Enter student ID">
<button onclick="getStudent()">Search</button>
<pre id="result"></pre>

<h2>Response:</h2>
<pre id="Student Info"></pre>


<script>
  function getStudent() {
    const studentId = document.getElementById('student_id');
    var mystudent = studentId.value;
    studentId.setAttribute = "chris";
    const formData = new FormData();
    formData.append('student_id', mystudent);
   
    fetch('http://localhost:5500/get_student_by_id?student_id=' + mystudent, {
        method: 'GET'
    })
    .then(response => {
        if (!response.ok) {
            throw new Error("Network response was not ok");
        }
        return response.json();
    })
    .then(data => {
        document.getElementById('result').textContent = JSON.stringify(data, null, 2);
    })
    .catch(error => {
        console.error('Error:', error);
        document.getElementById('result').textContent = 'Error retrieving student data.';
    });
}


    function sendData() {
        const studentId = document.getElementById('student_id').value;
        <!-- formData.append("student_id", studentId); -->
        fetch('/query', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ student_id: student_id })
        })
        .then(response => {
            if (!response.ok) throw new Error('Request failed');
            return "my script failed";
        })
        .then(data => {
          if (data.student) {
        const student = data.student;
        let output = "";
        for (const key in student) {
            output += `${key}: ${student[key]}\n`;
        }
            document.getElementById('responseBox').textContent = output;
        } else {
          document.getElementById('responseBox').textContent = data.message || 'No data found';
        }
      }).catch(error => {
            console.error('Error:', error);
            document.getElementById('responseBox').textContent = 'Request failed';
        });
    }

  async function fetchStudentById(studentId) {
  try {
    const response = await fetch('http://localhost:5000/query', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: (student_id )

    });

    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || 'Unknown error occurred');
    }

    const data = await response.json();
    console.log('Student Data:', data);
    const myElement = document.getElementById(student_div)
    myElement.innerHTML = data

    // Optionally, display data on the page
    if (data.student) {
      document.getElementById('result').textContent = JSON.stringify(data.student, null, 2);
    } else {
      document.getElementById('result').textContent = data.message;
    }

  } catch (error) {
    console.error('Fetch error:', error);
    document.getElementById('result').textContent = 'Error: ' + error.message;
  }
}

</script>

<!-- Here's a corrected and working version of your JavaScript 
 inside the existing HTML to properly send the student_id 
 to your Python backend (/query) and display the result: -->
 

    </center>
  </label>
  </body>
</html>
